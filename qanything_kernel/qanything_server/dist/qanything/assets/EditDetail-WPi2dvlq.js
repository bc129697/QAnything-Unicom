import { _ as e } from "./bot-avatar-CBCRm2Zm.js"; import { _ as a } from "./knowledge-zhu8jsrY.js"; import { u as t } from "./useBots-wIryKe1o.js"; import { r as l, u as s, a as o, b as n, c as i, C as c } from "./urlConfig-5Ad6E0st.js"; import { g as r, u } from "./index-DAdVxPIc.js"; import { a as d, C as p, u as m } from "./useChatOperate-DPEKD_Ao.js"; import { u as v } from "./useChatSetting-CpQu1AXT.js"; import { u as g } from "./useBotsChat-DZ8x0o0p.js"; import { d as h, j as f, r as A, a as k, o as w, k as b, y, H as C, c as _, q as S, v as x, z as I, F as B, x as F, M as D, E as R, n as j, A as q, B as T, W as L, Q as K, X as U, Y as E, D as O, J as H, K as Q, O as z, a0 as V, b as Y, l as X, N as M, aa as Z, G as W, p as P } from "./index-BVM7diGR.js"; import { u as G, D as J, f as N, h as $, C as ee, a as ae, _ as te, T as le } from "./ChatInfoPanel-Cxesx8km.js"; import { _ as se } from "./lock-DmQwPPsI.js"; import { a as oe, _ as ne } from "./index-BTL0xIAV.js"; import { I as ie } from "./index-C5w7Azth.js"; import { _ as ce } from "./LeftOutlined-BC9u9Wti.js"; import "./responsiveObserve-BPfiShJR.js"; import "./RightOutlined-DtsVRhmk.js"; import "./class-Cc8UO9Y6.js"; import "./index-BUlNCtQT.js"; import "./debounce-Dz27Iuya.js"; import "./collapseMotion-uYR2Sbzz.js"; import "./index-CBrli1tO.js"; import "./operationUnit-MUxBaQJQ.js"; const re = e => (U("data-v-abc3150a"), e = e(), E(), e), ue = { class: "bot-detail-edit-comp" }, de = { class: "name-avatar" }, pe = re((() => C("img", { src: e, alt: "avatar" }, null, -1))), me = { class: "title" }, ve = { class: "title" }, ge = { class: "title" }, he = re((() => C("span", null, "*", -1))), fe = re((() => C("img", { class: "knowledge-icon", src: a, alt: "knowledge" }, null, -1))), Ae = { class: "kb-name" }, ke = ["onClick"], we = re((() => C("img", { class: "add-knowedge", src: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAOBSURBVFiFzZixdeJAEIb/WZAiAjqADiiBwAUQOHOg97BlhQQUQEABBIRCZ7+ngMwBBThQARfQgegAv4cTOHYuuFksQBJIYM5/AojVzqcZ7ezsEDNX8IOl/jfAKVUvuTkMw/p6vW4TUUNrXWfmBgAQ0UIptWTmhW3bkeM4y7I2qGiIwzCsbzYbZ7vddoioxcz1k0aIZkQ0c103/FZA3/d7RDQwUES0ZOY5gDkRLYkoBgBmbsqYFoB2YopYKTUsAnoW4Ovra2uz2bwBaMqlSCk1Pid85jXQWvcSsHGtVrt7eHhYXAwYBIHDzCPxSCQeiE5NnDWX1noAoCkef3Jdd1YacDKZDJh5ID/Hnuf1y4Adyvf9EYAeABDR8Pn5eVgYMAiCjtb6TX72Pc8bXwPOKPnwSqnHrPcyFXA6nTY+Pz9/M3P91BNeIt/3ewBGRLSsVqt33W53fjgmNVGvVqt3eefG3wUHABKVMTPXZREe6QgwCAIH/1ZrfK13Lk9iIwLQFI/mA8oqg1KqsOeCIHDSjJySsUVEgzAM9xL/HmDCe1GZrK+1fgEwKnqfpK1IQu1kAjJzBwCUUlddsefI2Nxut5296+ZLGIZ1A2jbdqlEfIls244kebeSYd4Brtdrsw1dVH2UleM4S2aeM3M9wfIFSEQN+XqUi26o+QHLF6DWeleh3J7rn4xtwwIkCtZEsRnnTSIb/kveGN/3/2T8lbtlElHMzDsWoETJn3y6olJKFY7OzoNEtBD6Zt4NZntK+894zvO8UkcJY5uIdnVicpHEMqi0hy6VsZ30dDLEH/LZuiXUgVoAwMzHHsxKlLeS2GwbliPArER5KxmbRDRLbhR7q7hSqcwAQA44N5WxSUR7Z5Q9QMuyQkmW7SAIynixr5R6LHqTVFFtAPFhFbUHKGEeAl91YRF5njcuWaZl1qBHiVryXAygLaevb5XYaCLFe6mAAGBZ1r2EulemQj5Xk8lkAKBHRMtarXaXNiYVsNvtzonInEdGMtFV5ft+zxw7iegpq8uQuRe7rhsS0RAAmHlwzXDLXCOBG+Z1F85pfXSY+ZdsQ4WbPwdztWVBtGVT6J+a66zm0XQ6baxWq3dcsXlkWdZ92kG9FKBRsvmTuBwhp/2W7CFKu25YpI1SuIFpQJm5Yw5ZuQakh1ipVGaWZYVFzzulAI3yWsDizY+bt4BvrR/f5f8LxA8rSSHVBD4AAAAASUVORK5CYII=", alt: "icon" }, null, -1))), be = { class: "title" }, ye = { class: "chat-setting-form-footer" }, Ce = O(h({ __name: "BotDetailEdit", setup(e, { expose: a }) { const { curBot: o, knowledgeList: n } = f(t()), { QA_List: i } = f(g()), { setSelectKnowledgeVisible: c, setCurBot: u } = t(), { setChatSettingConfigured: p } = v(), { chatSettingFormActive: m } = f(v()), { bots: h, common: U } = r(), E = A(""), O = A(""), H = A(""), Q = k((() => O.value.match(/[^a-zA-Z\s]|\p{P}|\w+/g))); w((() => { E.value = o.value.bot_name, H.value = o.value.welcome_message, O.value = o.value.prompt_setting })); const z = async e => { try { const a = await l(await s.queryBotInfo({ bot_id: e })); u(a[0]) } catch (a) { q.error(a.msg || "获取Bot信息失败") } }, V = A(), Y = async (e, a = "应用成功") => { const t = await V.value.onCheck(); return !Object.hasOwn(t, "errorFields") && (await (async () => { try { await l(await s.updateBot({ bot_id: o.value.bot_id, bot_name: E.value, prompt_setting: O.value, welcome_message: H.value, only_need_search_results: m.value.capabilities.onlySearch, networking: m.value.capabilities.networkSearch, api_base: m.value.apiBase, api_key: m.value.apiKey, api_context_length: m.value.apiContextLength, top_p: m.value.top_P, temperature: m.value.temperature, top_k: m.value.top_K, model: m.value.apiModelName, max_token: m.value.maxToken, hybrid_search: m.value.capabilities.mixedSearch, chunk_size: m.value.chunkSize, rerank: m.value.capabilities.rerank })), await z(o.value.bot_id) } catch (e) { q.error(e.msg || "保存失败，请重试") } })(), p(t), q.success(a), !0) }; return a({ handleOk: Y }), (e, a) => { const t = T, r = L, u = K; return b(), y("div", ue, [C("div", de, [pe, _(t, { value: S(E), "onUpdate:value": a[0] || (a[0] = e => x(E) ? E.value = e : null), placeholder: S(h).inputBotName, "show-count": "", maxlength: 25 }, null, 8, ["value", "placeholder"])]), C("div", me, I(S(h).roleSetting), 1), _(r, { value: S(O), "onUpdate:value": a[1] || (a[1] = e => x(O) ? O.value = e : null), class: "role-setting-input", "auto-size": { minRows: 7, maxRows: 7 }, rows: 7 }, null, 8, ["value"]), C("div", { class: B(["role-setting-length", S(Q) && S(Q).length > 2e3 ? "over-length" : ""]) }, I(S(Q) ? S(Q).length : 0) + " / 2000 ", 3), C("div", ve, I(S(h).welcomeMessage), 1), _(r, { value: S(H), "onUpdate:value": a[2] || (a[2] = e => x(H) ? H.value = e : null), class: "greeting-input", "show-count": "", maxlength: 100, placeholder: S(h).inputWelcomMsg, "auto-size": { minRows: 6, maxRows: 6 }, rows: 6 }, null, 8, ["value", "placeholder"]), C("div", ge, [F(I(S(h).associatedKb), 1), he]), (b(!0), y(D, null, R(S(o).kb_ids, ((e, a) => (b(), y("div", { key: e, class: "knowedge-item knowledge-info" }, [fe, C("div", Ae, I(S(o).kb_names[a]), 1), C("img", { class: "remove-icon", src: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAQBSURBVFiF1Zk/aBtnFMB/73TWUJwUi0CoS4KHxEPw4n+0aQMpGWwPLaQYeywt0l0OFxwC7ZohawuhHoR9Z2jwaFEayFDbgyGQ4BaEp5DBWURCFZoauSTOoujuZdB3RpKNY8e25P4m6b67e7+7033fe0/C+yGO41wErgADItINdAInzPgroKiqa0AeWA6CYAXQfQfaz86u655V1QkR+Qb4aJ+xnqvqnIhkfd9/eqiCmUzmdCKRuKmqDtBmNj8BFkXkgao+LpfLz7q6ul4CFAqFk8lk8oyIXFDVS8AwcN4c90ZEgjAMb83Ozv5zYEHHcb4VkZ+AU0AFmAemfN//ay8XF+O67ifAJDAO2MC6qv4YBMGd9xIcGxtLplKp26o6YTYtqOr1IAjW9iPWiOM43SLyCzACICLZUql0I5fLlfcsODEx0V6pVH4DhoBN4Aff92cOItaI67rXgJ+BdmDJtu3RbDa7+U7BsbGxZEdHxz1gSFWLiURieHp6+tFhysV4ntcThuGiiHQCSxsbG1813kmr8aBUKnU7loui6PJRyQFMT08/iqLosqoWgSETu466O2heiF+BTcuyLh6lXC2e5/VEUbQCtKvqd7UvTiL+kMlkTluWdRf4AJicmZn5oxlyAPl8/kV/f38J+FJELvX29s6trq6+hppHnEgkblKdShYO+4XYCybmAnDKuLAlaFYIB6io6vVmy8WY2BVVdVzXPbslaOa6NmD+oPPcQTCx54G2eP61ADFrK8BUq+RqmAIwTiKO43wmIg+BJ77vd7fWrYrrumvAeVX93KKaMgEsttCpkdjligUMAIjIg9b51FPjMmCZZBNVfdxCpzpiFxHptqhmwpTL5WcttaqhxqXTxqTpcbK5G67r/g5cPWD8u77vf73bDl1dXS+LxSLAiW3JwnHDplrgfFgoFE4C/+2287uu/LAwJQPAKwsoAiSTyTPNCL4XalyKlikNEZELLXSqI3ZR1TWLat2Kqb6OBTUueQtYNl+GW+SzE7HLsgDiuu7fVAvxT/dbTh42pjz9E3ju+/7HFqCqOmfGJ1untsUkgHFSC6q1KfAGGHccp2UZjYk9TrX7kAWTsPq+/1REAsA2RXVLMLFtEQni/s3WShKG4S1gHRgxRXVTMTFHgHXjAtRUdaurq6/7+vr+FZGrwBeDg4P38vn8i2bIeZ7Xo6rzQFJVv5+dnX0Yj9WtxUEQ3DHPvj0Mw8V0On3uqOXS6fS5MAwXgXYRyTY2k7YlC6VS6QawJCKdlmXd9zyv56jkPM/rsSzrftz6MLHr2CaYy+XKtm2PxpJRFK0cxW/Sdd1rURStxHK2bY/u1OH6f7bfGk54PBuYtRzrFnAtx7aJvtNxzfob4i2ESvnrjyWOcQAAAABJRU5ErkJggg==", alt: "remove", onClick: a => (async e => { let a = o.value.kb_ids; a = a.filter((a => a != e)); try { await l(await s.updateBot({ bot_id: o.value.bot_id, kb_ids: a })), z(o.value.bot_id), n.value = n.value.map((a => (a.kb_id === e && (a.state = 0 === a.state ? 1 : 0), a))), q.success(h.removalSucessful) } catch (t) { q.error(t.msg || "请求失败") } })(e) }, null, 8, ke)])))), 128)), C("div", { class: "knowedge-item add-knowledge-content", onClick: a[3] || (a[3] = e => S(c)(!0)) }, [we, F(" " + I(S(h).clickAssociatedKb), 1)]), C("div", be, I(S(U).modelSettingTitle), 1), _(d, { ref_key: "chatSettingFormRef", ref: V, "context-length": S(i).length }, null, 8, ["context-length"]), C("div", ye, [_(u, { type: "primary", style: { width: "auto" }, onClick: Y }, { default: j((() => [F(I(S(U).confirmApplication), 1)])), _: 1 })])]) } } }), [["__scopeId", "data-v-abc3150a"]]), _e = e => (U("data-v-46a6bb21"), e = e(), E(), e), Se = { class: "bots-chat-container" }, xe = { class: "my-page" }, Ie = { class: "header" }, Be = _e((() => C("img", { src: e, alt: "avatar" }, null, -1))), Fe = { id: "chat", class: "chat" }, De = { class: "ai" }, Re = { class: "content" }, je = _e((() => C("img", { class: "avatar", src: ae, alt: "头像" }, null, -1))), qe = ["innerHTML"], Te = { key: 0, class: "user" }, Le = _e((() => C("img", { class: "avatar", src: te, alt: "头像" }, null, -1))), Ke = { class: "question-text" }, Ue = { key: 1, class: "ai" }, Ee = { class: "content" }, Oe = _e((() => C("img", { class: "avatar", src: ae, alt: "头像" }, null, -1))), He = { key: 1 }, Qe = { key: 0 }, ze = { key: 1 }, Ve = { class: "source-list" }, Ye = { class: "control" }, Xe = { class: "tips" }, Me = ["href"], Ze = ["onClick"], We = { class: "source-content" }, Pe = ["innerHTML"], Ge = { class: "score" }, Je = { class: "tips" }, Ne = { key: 2, class: "feed-back" }, $e = ["onClick"], ea = { class: "reload-text" }, aa = { class: "tools" }, ta = { class: "stop-placeholder" }, la = { class: "question-box" }, sa = { class: "question" }, oa = { class: "send-box" }, na = { class: "send-action" }, ia = { key: 0, class: "mask" }, ca = _e((() => C("img", { src: se, alt: "icon" }, null, -1))), ra = O(h({ __name: "Chat", props: { chatType: { type: String, default: "edit" }, botInfo: { type: Object, default: () => { } } }, setup(e) { const { like: a, unlike: t, copy: d, deleteChatItem: h } = m(), w = e, T = r().common, U = r().bots, E = new le((e => { e && (O.value[O.value.length - 1].answer += e || "") })), { QA_List: O } = f(g()), { chatSettingFormActive: P } = f(v()), { setChatSourceVisible: ae, setSourceType: te, setSourceUrl: se, setTextContent: re } = oe(), { language: ue } = f(u()), de = A(""), pe = k((() => { const e = P.value.context; if (0 === e) return []; const a = O.value.filter((e => "ai" === e.type)); return (11 === e ? a : a.slice(-e)).map((e => [e.question, e.answer])) })), me = A(!1), ve = A([]); let ge; const he = A(null), fe = A(null), Ae = () => { V((() => { var e; null == (e = he.value) || e.scrollIntoView(!1) })) }, ke = new c, we = () => { ge && ge.abort(), E.done(), me.value = !1, O.value[O.value.length - 1].showTools = !0 }, be = e => { 13 === e.keyCode && (e.altKey || e.ctrlKey || e.shiftKey || e.metaKey ? de.value += "\n" : ye(), e.preventDefault()) }, ye = async () => { var e; if (!de.value.trim().length) return; if (!de.value.length) return void q.warn("正在聊天中...请等待结束"); if (!(await ga())) return void q.error("模型设置错误，请先检查模型配置"); if (!((de.value.match(/@/g) || []).length <= 10)) return void q.error("不可@超过10个"); const a = de.value; de.value = "", (e => { O.value.push({ question: e, type: "user" }), Ae() })(a), me.value = !0, null == (e = he.value) || e.scrollIntoView(!0), ge = new AbortController; N(i + "/rag/local_doc_chat", { method: "POST", headers: { "Content-Type": "application/json", Accept: ["text/event-stream", "application/json"], "Transfer-Encoding": "chunked", Connection: "keep-alive" }, openWhenHidden: !0, body: JSON.stringify({ user_id: o, user_info: n, bot_id: w.botInfo.bot_id, history: pe.value, question: a, streaming: !1 === P.value.capabilities.onlySearch, product_source: "saas" }), signal: ge.signal, onopen(e) { (e => { O.value.push({ answer: "", question: e, onlySearch: P.value.capabilities.onlySearch, type: "ai", copied: !1, like: !1, unlike: !1, source: [], picList: null, showTools: !1 }) })(a), e.ok && "text/event-stream" === e.headers.get("content-type") ? (ke.addChatSetting(P.value), E.start()) : "application/json" === e.headers.get("content-type") && E.add("Error 请检查模型是否配置正确") }, onmessage(e) { var a; const t = JSON.parse(e.data); if (200 == (null == t ? void 0 : t.code) && (null == t ? void 0 : t.response) && "success" === t.msg) E.add(null == t ? void 0 : t.response.replaceAll("\n", "<br/>")), Ae(); else { delete t.time_record.time_usage.retriever_search_by_milvus, ke.addTime(t.time_record.time_usage), ke.addToken(t.time_record.token_usage), ke.addDate(Date.now()) } (null == (a = null == t ? void 0 : t.source_documents) ? void 0 : a.length) && (O.value[O.value.length - 1].source = null == t ? void 0 : t.source_documents) }, onclose(e) { E.done(), ge.abort(), me.value = !1, O.value[O.value.length - 1].showTools = !0, O.value.at(-1).itemInfo = ke.getChatInfo(), V((() => { Ae() })) }, onerror(e) { throw E.done(), ge.abort(), me.value = !1, O.value[O.value.length - 1].showTools = !0, V((() => { Ae() })), e } }) }, { showModal: Ce } = f(G()), { clearQAList: _e } = g(), ra = A(!1), ua = A(""), da = A(""), pa = () => { da.value = "download", Ce.value = !0, ua.value = T.saveTip }, ma = async () => { if (ra.value = !0, "download" === da.value) try { const e = document.getElementById("chat-ul"), a = (await $(e, { useCORS: !0 })).toDataURL("image/png"), t = document.createElement("a"); t.style.display = "none", t.href = a, t.setAttribute("download", "chat-shot.png"), void 0 === t.download && t.setAttribute("target", "_blank"), document.body.appendChild(t), t.click(), document.body.removeChild(t), window.URL.revokeObjectURL(a), q.success(U.downloadSuccessful), Promise.resolve() } catch (e) { q.error(e.message || e.msg || "出错了") } else "delete" === da.value && _e(); da.value = "", ua.value = "", ra.value = !1, Ce.value = !1 }, va = Y("checkSettingOk"), ga = async () => await va(); let ha = ["md", "txt", "pdf", "jpg", "png", "jpeg", "doc", "docx", "xls", "xlsx", "ppt", "pptx", "jsonl", "csv", "eml"]; const fa = e => { if (!e) return !1; const a = e.split("."); if (a.length) { const e = a.pop(); return !!ha.includes(e) } return !1 }, Aa = e => { fa(e.file_name) && async function (e) { try { se(null); const a = await l(await s.getFile({ file_id: e.file_id })), t = e.file_name.split(".").pop(), o = function (e) { const a = ha.indexOf(e); return ka[a] }(t); if (te(t), se(`data:${o};base64,${a.base64_content}`), "txt" === t) { const e = atob(a.base64_content), t = decodeURIComponent(escape(e)); re(t), ae(!0) } else ae(!0) } catch (a) { q.error(a.msg || "获取文件失败") } }(e) }; let ka = ["text/markdown", "text/plain", "application/pdf", "image/jpeg", "image/png", "image/jpeg", "application/msword", "application/vnd.openxmlformats-officedocument.wordprocessingml.document", "application/vnd.ms-excel", "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "application/vnd.ms-powerpoint", "application/vnd.openxmlformats-officedocument.presentationml.presentation", "application/jsonl", "text/csv", "message/rfc822"]; return Ae(), (l, s) => { const o = ie, n = K, i = L, c = ce; return b(), y(D, null, [C("div", Se, [C("div", xe, [C("div", Ie, [Be, F(" " + I(e.botInfo.bot_name), 1)]), C("div", Fe, [C("ul", { id: "chat-ul", ref_key: "scrollDom", ref: he }, [C("div", De, [C("div", Re, [je, C("p", { class: "question-text", innerHTML: e.botInfo.welcome_message }, null, 8, qe)])]), (b(!0), y(D, null, R(S(O), ((e, l) => { var s, n, i; return b(), y("li", { key: l }, ["user" === e.type ? (b(), y("div", Te, [Le, C("p", Ke, I(e.question), 1)])) : (b(), y("div", Ue, [C("div", Ee, [Oe, e.onlySearch ? z("", !0) : (b(), y("p", { key: 0, class: B(["question-text", [e.source.length || (null == (s = null == e ? void 0 : e.picList) ? void 0 : s.length) ? "" : "change-radius", e.showTools ? "" : "flashing"]]) }, [e.answer ? (b(), X(ne, { key: 0, content: e.answer }, null, 8, ["content"])) : (b(), y("span", He, I(e.answer), 1)), Object.keys((null == (n = null == e ? void 0 : e.itemInfo) ? void 0 : n.tokenInfo) || {}).length ? (b(), X(ee, { key: 2, "chat-item-info": e.itemInfo }, null, 8, ["chat-item-info"])) : z("", !0)], 2))]), (null == (i = null == e ? void 0 : e.picList) ? void 0 : i.length) ? (b(!0), y(D, { key: 0 }, R(e.picList, ((a, t) => (b(), y("div", { key: a + t, class: B(["data-picList", e.source.length || t + 1 !== e.picList.length ? "" : "picList-radius"]) }, [_(o, { width: 150, src: a, class: "responsive-image" }, null, 8, ["src"])], 2)))), 128)) : z("", !0), e.source.length ? (b(), y(D, { key: 1 }, [C("div", { class: B(["source-total", S(ve).includes(l) ? "" : "source-total-last"]) }, ["zh" === S(ue) ? (b(), y("span", Qe, "找到了" + I(e.source.length) + "个信息来源：", 1)) : (b(), y("span", ze, "Found " + I(e.source.length) + " source of information", 1)), H(_(M, { name: "down", onClick: e => (e => { ve.value.push(e) })(l) }, null, 8, ["onClick"]), [[Q, !S(ve).includes(l)]]), H(_(M, { name: "up", onClick: e => (e => { ve.value = ve.value.filter((a => a !== e)) })(l) }, null, 8, ["onClick"]), [[Q, S(ve).includes(l)]])], 2), H(C("div", Ve, [(b(!0), y(D, null, R(e.source, ((a, t) => (b(), y("div", { key: t, class: "data-source" }, [H(C("p", Ye, [C("span", Xe, I(S(T).dataSource) + I(t + 1) + ":", 1), a.file_id.startsWith("http") ? (b(), y("a", { key: 0, href: a.file_id, target: "_blank" }, I(a.file_name), 9, Me)) : (b(), y("span", { key: 1, class: B(["file", fa(a.file_name) ? "filename-active" : ""]), onClick: e => Aa(a) }, I(a.file_name), 11, Ze)), H(_(M, { name: "iconup", onClick: a => ((e, a) => { e.source[a].showDetailDataSource = !1 })(e, t) }, null, 8, ["onClick"]), [[Q, a.showDetailDataSource]]), H(_(M, { name: "icondown", onClick: a => ((e, a) => { e.source[a].showDetailDataSource = !e.source[a].showDetailDataSource })(e, t) }, null, 8, ["onClick"]), [[Q, !a.showDetailDataSource]])], 512), [[Q, a.file_name]]), _(Z, { name: "sourceitem" }, { default: j((() => { var e; return [H(C("div", We, [C("p", { innerHTML: null == (e = a.content) ? void 0 : e.replaceAll("\n", "<br/>") }, null, 8, Pe), C("p", Ge, [C("span", Je, I(S(T).correlation), 1), F(I(a.score), 1)])], 512), [[Q, a.showDetailDataSource]])] })), _: 2 }, 1024)])))), 128))], 512), [[Q, S(ve).includes(l)]])], 64)) : z("", !0), e.showTools ? (b(), y("div", Ne, [C("div", { class: "reload-box", onClick: a => (e => { de.value = e.question, ye() })(e) }, [_(M, { name: "reload" }), C("span", ea, I(S(T).regenerate), 1)], 8, $e), C("div", aa, [_(M, { style: W({ color: e.copied ? "#4D71FF" : "" }), name: "copy", onClick: a => S(d)(e) }, null, 8, ["style", "onClick"]), _(M, { style: W({ color: e.like ? "#4D71FF" : "" }), name: "like", onClick: t => S(a)(e) }, null, 8, ["style", "onClick"]), _(M, { style: W({ color: e.unlike ? "#4D71FF" : "" }), name: "unlike", onClick: a => S(t)(e) }, null, 8, ["style", "onClick"]), _(M, { class: "delete-icon", name: "delete", onClick: a => S(h)(e, S(O)) }, null, 8, ["onClick"])])])) : z("", !0)]))]) })), 128)), H(C("div", ta, null, 512), [[Q, S(me)]]), H(C("div", { ref_key: "stopBtn", ref: fe, class: "stop-btn" }, [_(n, { onClick: we }, { icon: j((() => [_(M, { name: "stop", class: B(S(me) ? "loading" : "") }, null, 8, ["class"])])), default: j((() => [F(" " + I(S(T).stop), 1)])), _: 1 })], 512), [[Q, S(me)]])], 512)]), C("div", la, [C("div", sa, [C("div", oa, [_(i, { value: S(de), "onUpdate:value": s[0] || (s[0] = e => x(de) ? de.value = e : null), class: "send-textarea", "max-length": "200", bordered: !1, placeholder: S(T).problemPlaceholder, "auto-size": { minRows: 1, maxRows: 8 }, onKeydown: be }, null, 8, ["value", "placeholder"]), C("div", na, [_(c, { placement: "topLeft" }, { content: j((() => [F(I(S(T).chatToPic), 1)])), default: j((() => [C("span", { class: B(["download", S(me) ? "isPreventClick" : ""]), onClick: pa }, [_(M, { name: "chat-download" })], 2)])), _: 1 }), _(n, { type: "primary", disabled: S(me), shape: "circle", onClick: ye }, { default: j((() => [_(M, { name: "sendplane" })])), _: 1 }, 8, ["disabled"])])])])])]), e.botInfo.kb_ids && e.botInfo.kb_ids.length ? z("", !0) : (b(), y("div", ia, [ca, C("p", null, I(S(U).bindKbtoPreview), 1)])), _(p, { ref: "chatSettingForDialogRef" }, null, 512)]), _(J, { content: S(ua), "confirm-loading": S(ra), onOk: ma }, null, 8, ["content", "confirm-loading"])], 64) } } }), [["__scopeId", "data-v-46a6bb21"]]), ua = { class: "edit-detail" }, da = { class: "bots-chat-page" }, pa = O(h({ __name: "EditDetail", setup(e) { const { curBot: a } = f(t()), l = A(); return P("checkSettingOk", (() => l.value.handleOk(null, "模型配置已自动保存"))), (e, t) => (b(), y("div", ua, [_(Ce, { ref_key: "botDetailEditRef", ref: l }, null, 512), C("div", da, [_(ra, { "bot-info": S(a), "chat-type": "edit" }, null, 8, ["bot-info"])])])) } }), [["__scopeId", "data-v-9f3e3839"]]); export { pa as default };
