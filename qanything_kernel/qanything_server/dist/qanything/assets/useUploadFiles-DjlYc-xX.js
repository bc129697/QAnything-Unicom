import{r as e,u as t,d as l,g as n,h as i}from"./urlConfig-5Ad6E0st.js";import{u as a}from"./useKnowledgeBase-DZuffAZO.js";import{g as o,m as s,_ as r,a5 as u,c,I as d,ab as h,ac as f,d as g,a as v,s as m,az as p,w,h as C,M as y,ax as E,aA as M,u as b,aB as _,r as R,Q as S,j as N,am as A,A as L,k,l as P,n as I,H as x,z,q as T,x as O,v as F,T as D,R as U,D as B}from"./index-BVM7diGR.js";import{g as Q}from"./index-DAdVxPIc.js";import{u as $}from"./useBots-wIryKe1o.js";import{S as H}from"./index-BFggBRAt.js";const V=o("QRCode",(e=>(e=>{const{componentCls:t}=e;return{[t]:r(r({},u(e)),{display:"flex",justifyContent:"center",alignItems:"center",padding:e.paddingSM,backgroundColor:e.colorWhite,borderRadius:e.borderRadiusLG,border:`${e.lineWidth}px ${e.lineType} ${e.colorSplit}`,position:"relative",width:"100%",height:"100%",overflow:"hidden",[`& > ${t}-mask`]:{position:"absolute",insetBlockStart:0,insetInlineStart:0,zIndex:10,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",color:e.colorText,lineHeight:e.lineHeight,background:e.QRCodeMaskBackgroundColor,textAlign:"center",[`& > ${t}-expired , & > ${t}-scanned`]:{color:e.QRCodeTextColor}},"&-icon":{marginBlockEnd:e.marginXS,fontSize:e.controlHeight}}),[`${t}-borderless`]:{borderColor:"transparent"}}})(s(e,{QRCodeTextColor:"rgba(0, 0, 0, 0.88)",QRCodeMaskBackgroundColor:"rgba(255, 255, 255, 0.96)"}))));var j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"};function q(e){for(var t=1;t<arguments.length;t++){var l=null!=arguments[t]?Object(arguments[t]):{},n=Object.keys(l);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(l).filter((function(e){return Object.getOwnPropertyDescriptor(l,e).enumerable})))),n.forEach((function(t){Y(e,t,l[t])}))}return e}function Y(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}var K=function(e,t){var l=q({},e,t.attrs);return c(d,q({},l,{icon:j}),null)};K.displayName="ReloadOutlined",K.inheritAttrs=!1;const G=()=>({size:{type:Number,default:160},value:{type:String,required:!0},type:h("canvas"),color:String,bgColor:String,includeMargin:Boolean,imageSettings:f()});
/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */
var W,X;!function(e){class t{static encodeText(l,n){const i=e.QrSegment.makeSegments(l);return t.encodeSegments(i,n)}static encodeBinary(l,n){const i=e.QrSegment.makeBytes(l);return t.encodeSegments([i],n)}static encodeSegments(e,n){let o,s,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:40,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,d=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if(!(t.MIN_VERSION<=r&&r<=u&&u<=t.MAX_VERSION)||c<-1||c>7)throw new RangeError("Invalid value");for(o=r;;o++){const l=8*t.getNumDataCodewords(o,n),i=a.getTotalBits(e,o);if(i<=l){s=i;break}if(o>=u)throw new RangeError("Data too long")}for(const l of[t.Ecc.MEDIUM,t.Ecc.QUARTILE,t.Ecc.HIGH])d&&s<=8*t.getNumDataCodewords(o,l)&&(n=l);const h=[];for(const t of e){l(t.mode.modeBits,4,h),l(t.numChars,t.mode.numCharCountBits(o),h);for(const e of t.getData())h.push(e)}i(h.length==s);const f=8*t.getNumDataCodewords(o,n);i(h.length<=f),l(0,Math.min(4,f-h.length),h),l(0,(8-h.length%8)%8,h),i(h.length%8==0);for(let t=236;h.length<f;t^=253)l(t,8,h);const g=[];for(;8*g.length<h.length;)g.push(0);return h.forEach(((e,t)=>g[t>>>3]|=e<<7-(7&t))),new t(o,n,g,c)}constructor(e,l,n,a){if(this.version=e,this.errorCorrectionLevel=l,this.modules=[],this.isFunction=[],e<t.MIN_VERSION||e>t.MAX_VERSION)throw new RangeError("Version value out of range");if(a<-1||a>7)throw new RangeError("Mask value out of range");this.size=4*e+17;const o=[];for(let t=0;t<this.size;t++)o.push(!1);for(let t=0;t<this.size;t++)this.modules.push(o.slice()),this.isFunction.push(o.slice());this.drawFunctionPatterns();const s=this.addEccAndInterleave(n);if(this.drawCodewords(s),-1==a){let e=1e9;for(let t=0;t<8;t++){this.applyMask(t),this.drawFormatBits(t);const l=this.getPenaltyScore();l<e&&(a=t,e=l),this.applyMask(t)}}i(0<=a&&a<=7),this.mask=a,this.applyMask(a),this.drawFormatBits(a),this.isFunction=[]}getModule(e,t){return 0<=e&&e<this.size&&0<=t&&t<this.size&&this.modules[t][e]}getModules(){return this.modules}drawFunctionPatterns(){for(let l=0;l<this.size;l++)this.setFunctionModule(6,l,l%2==0),this.setFunctionModule(l,6,l%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const e=this.getAlignmentPatternPositions(),t=e.length;for(let l=0;l<t;l++)for(let n=0;n<t;n++)0==l&&0==n||0==l&&n==t-1||l==t-1&&0==n||this.drawAlignmentPattern(e[l],e[n]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(e){const t=this.errorCorrectionLevel.formatBits<<3|e;let l=t;for(let n=0;n<10;n++)l=l<<1^1335*(l>>>9);const a=21522^(t<<10|l);i(a>>>15==0);for(let i=0;i<=5;i++)this.setFunctionModule(8,i,n(a,i));this.setFunctionModule(8,7,n(a,6)),this.setFunctionModule(8,8,n(a,7)),this.setFunctionModule(7,8,n(a,8));for(let i=9;i<15;i++)this.setFunctionModule(14-i,8,n(a,i));for(let i=0;i<8;i++)this.setFunctionModule(this.size-1-i,8,n(a,i));for(let i=8;i<15;i++)this.setFunctionModule(8,this.size-15+i,n(a,i));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let e=this.version;for(let l=0;l<12;l++)e=e<<1^7973*(e>>>11);const t=this.version<<12|e;i(t>>>18==0);for(let l=0;l<18;l++){const e=n(t,l),i=this.size-11+l%3,a=Math.floor(l/3);this.setFunctionModule(i,a,e),this.setFunctionModule(a,i,e)}}drawFinderPattern(e,t){for(let l=-4;l<=4;l++)for(let n=-4;n<=4;n++){const i=Math.max(Math.abs(n),Math.abs(l)),a=e+n,o=t+l;0<=a&&a<this.size&&0<=o&&o<this.size&&this.setFunctionModule(a,o,2!=i&&4!=i)}}drawAlignmentPattern(e,t){for(let l=-2;l<=2;l++)for(let n=-2;n<=2;n++)this.setFunctionModule(e+n,t+l,1!=Math.max(Math.abs(n),Math.abs(l)))}setFunctionModule(e,t,l){this.modules[t][e]=l,this.isFunction[t][e]=!0}addEccAndInterleave(e){const l=this.version,n=this.errorCorrectionLevel;if(e.length!=t.getNumDataCodewords(l,n))throw new RangeError("Invalid argument");const a=t.NUM_ERROR_CORRECTION_BLOCKS[n.ordinal][l],o=t.ECC_CODEWORDS_PER_BLOCK[n.ordinal][l],s=Math.floor(t.getNumRawDataModules(l)/8),r=a-s%a,u=Math.floor(s/a),c=[],d=t.reedSolomonComputeDivisor(o);for(let i=0,f=0;i<a;i++){const l=e.slice(f,f+u-o+(i<r?0:1));f+=l.length;const n=t.reedSolomonComputeRemainder(l,d);i<r&&l.push(0),c.push(l.concat(n))}const h=[];for(let t=0;t<c[0].length;t++)c.forEach(((e,l)=>{(t!=u-o||l>=r)&&h.push(e[t])}));return i(h.length==s),h}drawCodewords(e){if(e.length!=Math.floor(t.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let l=0;for(let t=this.size-1;t>=1;t-=2){6==t&&(t=5);for(let i=0;i<this.size;i++)for(let a=0;a<2;a++){const o=t-a,s=!(t+1&2)?this.size-1-i:i;!this.isFunction[s][o]&&l<8*e.length&&(this.modules[s][o]=n(e[l>>>3],7-(7&l)),l++)}}i(l==8*e.length)}applyMask(e){if(e<0||e>7)throw new RangeError("Mask value out of range");for(let t=0;t<this.size;t++)for(let l=0;l<this.size;l++){let n;switch(e){case 0:n=(l+t)%2==0;break;case 1:n=t%2==0;break;case 2:n=l%3==0;break;case 3:n=(l+t)%3==0;break;case 4:n=(Math.floor(l/3)+Math.floor(t/2))%2==0;break;case 5:n=l*t%2+l*t%3==0;break;case 6:n=(l*t%2+l*t%3)%2==0;break;case 7:n=((l+t)%2+l*t%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[t][l]&&n&&(this.modules[t][l]=!this.modules[t][l])}}getPenaltyScore(){let e=0;for(let i=0;i<this.size;i++){let l=!1,n=0;const a=[0,0,0,0,0,0,0];for(let o=0;o<this.size;o++)this.modules[i][o]==l?(n++,5==n?e+=t.PENALTY_N1:n>5&&e++):(this.finderPenaltyAddHistory(n,a),l||(e+=this.finderPenaltyCountPatterns(a)*t.PENALTY_N3),l=this.modules[i][o],n=1);e+=this.finderPenaltyTerminateAndCount(l,n,a)*t.PENALTY_N3}for(let i=0;i<this.size;i++){let l=!1,n=0;const a=[0,0,0,0,0,0,0];for(let o=0;o<this.size;o++)this.modules[o][i]==l?(n++,5==n?e+=t.PENALTY_N1:n>5&&e++):(this.finderPenaltyAddHistory(n,a),l||(e+=this.finderPenaltyCountPatterns(a)*t.PENALTY_N3),l=this.modules[o][i],n=1);e+=this.finderPenaltyTerminateAndCount(l,n,a)*t.PENALTY_N3}for(let i=0;i<this.size-1;i++)for(let l=0;l<this.size-1;l++){const n=this.modules[i][l];n==this.modules[i][l+1]&&n==this.modules[i+1][l]&&n==this.modules[i+1][l+1]&&(e+=t.PENALTY_N2)}let l=0;for(const t of this.modules)l=t.reduce(((e,t)=>e+(t?1:0)),l);const n=this.size*this.size,a=Math.ceil(Math.abs(20*l-10*n)/n)-1;return i(0<=a&&a<=9),e+=a*t.PENALTY_N4,i(0<=e&&e<=2568888),e}getAlignmentPatternPositions(){if(1==this.version)return[];{const e=Math.floor(this.version/7)+2,t=32==this.version?26:2*Math.ceil((4*this.version+4)/(2*e-2)),l=[6];for(let n=this.size-7;l.length<e;n-=t)l.splice(1,0,n);return l}}static getNumRawDataModules(e){if(e<t.MIN_VERSION||e>t.MAX_VERSION)throw new RangeError("Version number out of range");let l=(16*e+128)*e+64;if(e>=2){const t=Math.floor(e/7)+2;l-=(25*t-10)*t-55,e>=7&&(l-=36)}return i(208<=l&&l<=29648),l}static getNumDataCodewords(e,l){return Math.floor(t.getNumRawDataModules(e)/8)-t.ECC_CODEWORDS_PER_BLOCK[l.ordinal][e]*t.NUM_ERROR_CORRECTION_BLOCKS[l.ordinal][e]}static reedSolomonComputeDivisor(e){if(e<1||e>255)throw new RangeError("Degree out of range");const l=[];for(let t=0;t<e-1;t++)l.push(0);l.push(1);let n=1;for(let i=0;i<e;i++){for(let e=0;e<l.length;e++)l[e]=t.reedSolomonMultiply(l[e],n),e+1<l.length&&(l[e]^=l[e+1]);n=t.reedSolomonMultiply(n,2)}return l}static reedSolomonComputeRemainder(e,l){const n=l.map((e=>0));for(const i of e){const e=i^n.shift();n.push(0),l.forEach(((l,i)=>n[i]^=t.reedSolomonMultiply(l,e)))}return n}static reedSolomonMultiply(e,t){if(e>>>8!=0||t>>>8!=0)throw new RangeError("Byte out of range");let l=0;for(let n=7;n>=0;n--)l=l<<1^285*(l>>>7),l^=(t>>>n&1)*e;return i(l>>>8==0),l}finderPenaltyCountPatterns(e){const t=e[1];i(t<=3*this.size);const l=t>0&&e[2]==t&&e[3]==3*t&&e[4]==t&&e[5]==t;return(l&&e[0]>=4*t&&e[6]>=t?1:0)+(l&&e[6]>=4*t&&e[0]>=t?1:0)}finderPenaltyTerminateAndCount(e,t,l){return e&&(this.finderPenaltyAddHistory(t,l),t=0),t+=this.size,this.finderPenaltyAddHistory(t,l),this.finderPenaltyCountPatterns(l)}finderPenaltyAddHistory(e,t){0==t[0]&&(e+=this.size),t.pop(),t.unshift(e)}}function l(e,t,l){if(t<0||t>31||e>>>t!=0)throw new RangeError("Value out of range");for(let n=t-1;n>=0;n--)l.push(e>>>n&1)}function n(e,t){return!!(e>>>t&1)}function i(e){if(!e)throw new Error("Assertion error")}t.MIN_VERSION=1,t.MAX_VERSION=40,t.PENALTY_N1=3,t.PENALTY_N2=3,t.PENALTY_N3=40,t.PENALTY_N4=10,t.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],t.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=t;class a{static makeBytes(e){const t=[];for(const n of e)l(n,8,t);return new a(a.Mode.BYTE,e.length,t)}static makeNumeric(e){if(!a.isNumeric(e))throw new RangeError("String contains non-numeric characters");const t=[];for(let n=0;n<e.length;){const i=Math.min(e.length-n,3);l(parseInt(e.substring(n,n+i),10),3*i+1,t),n+=i}return new a(a.Mode.NUMERIC,e.length,t)}static makeAlphanumeric(e){if(!a.isAlphanumeric(e))throw new RangeError("String contains unencodable characters in alphanumeric mode");const t=[];let n;for(n=0;n+2<=e.length;n+=2){let i=45*a.ALPHANUMERIC_CHARSET.indexOf(e.charAt(n));i+=a.ALPHANUMERIC_CHARSET.indexOf(e.charAt(n+1)),l(i,11,t)}return n<e.length&&l(a.ALPHANUMERIC_CHARSET.indexOf(e.charAt(n)),6,t),new a(a.Mode.ALPHANUMERIC,e.length,t)}static makeSegments(e){return""==e?[]:a.isNumeric(e)?[a.makeNumeric(e)]:a.isAlphanumeric(e)?[a.makeAlphanumeric(e)]:[a.makeBytes(a.toUtf8ByteArray(e))]}static makeEci(e){const t=[];if(e<0)throw new RangeError("ECI assignment value out of range");if(e<128)l(e,8,t);else if(e<16384)l(2,2,t),l(e,14,t);else{if(!(e<1e6))throw new RangeError("ECI assignment value out of range");l(6,3,t),l(e,21,t)}return new a(a.Mode.ECI,0,t)}static isNumeric(e){return a.NUMERIC_REGEX.test(e)}static isAlphanumeric(e){return a.ALPHANUMERIC_REGEX.test(e)}constructor(e,t,l){if(this.mode=e,this.numChars=t,this.bitData=l,t<0)throw new RangeError("Invalid argument");this.bitData=l.slice()}getData(){return this.bitData.slice()}static getTotalBits(e,t){let l=0;for(const n of e){const e=n.mode.numCharCountBits(t);if(n.numChars>=1<<e)return 1/0;l+=4+e+n.bitData.length}return l}static toUtf8ByteArray(e){e=encodeURI(e);const t=[];for(let l=0;l<e.length;l++)"%"!=e.charAt(l)?t.push(e.charCodeAt(l)):(t.push(parseInt(e.substring(l+1,l+3),16)),l+=2);return t}}a.NUMERIC_REGEX=/^[0-9]*$/,a.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,a.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",e.QrSegment=a}(W||(W={})),function(e){class t{constructor(e,t){this.ordinal=e,this.formatBits=t}}t.LOW=new t(0,1),t.MEDIUM=new t(1,0),t.QUARTILE=new t(2,3),t.HIGH=new t(3,2),e.Ecc=t}((X=W||(W={})).QrCode||(X.QrCode={})),function(e){!function(e){class t{constructor(e,t){this.modeBits=e,this.numBitsCharCount=t}numCharCountBits(e){return this.numBitsCharCount[Math.floor((e+7)/17)]}}t.NUMERIC=new t(1,[10,12,14]),t.ALPHANUMERIC=new t(2,[9,11,13]),t.BYTE=new t(4,[8,16,16]),t.KANJI=new t(8,[8,10,12]),t.ECI=new t(7,[0,0,0]),e.Mode=t}(e.QrSegment||(e.QrSegment={}))}(W||(W={}));const J={L:W.QrCode.Ecc.LOW,M:W.QrCode.Ecc.MEDIUM,Q:W.QrCode.Ecc.QUARTILE,H:W.QrCode.Ecc.HIGH},Z=128,ee="L",te="#FFFFFF",le="#000000",ne=!1;function ie(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const l=[];return e.forEach((function(e,n){let i=null;e.forEach((function(a,o){if(!a&&null!==i)return l.push(`M${i+t} ${n+t}h${o-i}v1H${i+t}z`),void(i=null);if(o!==e.length-1)a&&null===i&&(i=o);else{if(!a)return;null===i?l.push(`M${o+t},${n+t} h1v1H${o+t}z`):l.push(`M${i+t},${n+t} h${o+1-i}v1H${i+t}z`)}}))})),l.join("")}function ae(e,t){return e.slice().map(((e,l)=>l<t.y||l>=t.y+t.h?e:e.map(((e,l)=>(l<t.x||l>=t.x+t.w)&&e))))}function oe(e,t,l,n){if(null==n)return null;const i=e.length+2*l,a=Math.floor(.1*t),o=i/t,s=(n.width||a)*o,r=(n.height||a)*o,u=null==n.x?e.length/2-s/2:n.x*o,c=null==n.y?e.length/2-r/2:n.y*o;let d=null;if(n.excavate){const e=Math.floor(u),t=Math.floor(c);d={x:e,y:t,w:Math.ceil(s+u-e),h:Math.ceil(r+c-t)}}return{x:u,y:c,h:r,w:s,excavation:d}}function se(e,t){return null!=t?Math.floor(t):e?4:0}const re=function(){try{(new Path2D).addPath(new Path2D)}catch(e){return!1}return!0}(),ue=g({name:"QRCodeCanvas",inheritAttrs:!1,props:r(r({},G()),{level:String,bgColor:String,fgColor:String,marginSize:Number}),setup(e,t){let{attrs:l,expose:n}=t;const i=v((()=>{var t;return null===(t=e.imageSettings)||void 0===t?void 0:t.src})),a=m(null),o=m(null),s=m(!1);return n({toDataURL:(e,t)=>{var l;return null===(l=a.value)||void 0===l?void 0:l.toDataURL(e,t)}}),p((()=>{const{value:t,size:l=Z,level:n=ee,bgColor:i=te,fgColor:r=le,includeMargin:u=ne,marginSize:c,imageSettings:d}=e;if(null!=a.value){const e=a.value,h=e.getContext("2d");if(!h)return;let f=W.QrCode.encodeText(t,J[n]).getModules();const g=se(u,c),v=f.length+2*g,m=oe(f,l,g,d),p=o.value,w=s.value&&null!=m&&null!==p&&p.complete&&0!==p.naturalHeight&&0!==p.naturalWidth;w&&null!=m.excavation&&(f=ae(f,m.excavation));const C=window.devicePixelRatio||1;e.height=e.width=l*C;const y=l/v*C;h.scale(y,y),h.fillStyle=i,h.fillRect(0,0,v,v),h.fillStyle=r,re?h.fill(new Path2D(ie(f,g))):f.forEach((function(e,t){e.forEach((function(e,l){e&&h.fillRect(l+g,t+g,1,1)}))})),w&&h.drawImage(p,m.x+g,m.y+g,m.w,m.h)}}),{flush:"post"}),w(i,(()=>{s.value=!1})),()=>{var t;const n=null!==(t=e.size)&&void 0!==t?t:Z,r={height:`${n}px`,width:`${n}px`};let u=null;return null!=i.value&&(u=c("img",{src:i.value,key:i.value,style:{display:"none"},onLoad:()=>{s.value=!0},ref:o},null)),c(y,null,[c("canvas",C(C({},l),{},{style:[r,l.style],ref:a}),null),u])}}}),ce=g({name:"QRCodeSVG",inheritAttrs:!1,props:r(r({},G()),{color:String,level:String,bgColor:String,fgColor:String,marginSize:Number,title:String}),setup(e){let t=null,l=null,n=null,i=null,a=null,o=null;return p((()=>{const{value:s,size:r=Z,level:u=ee,includeMargin:d=ne,marginSize:h,imageSettings:f}=e;t=W.QrCode.encodeText(s,J[u]).getModules(),l=se(d,h),n=t.length+2*l,i=oe(t,r,l,f),null!=f&&null!=i&&(null!=i.excavation&&(t=ae(t,i.excavation)),o=c("image",{"xlink:href":f.src,height:i.h,width:i.w,x:i.x+l,y:i.y+l,preserveAspectRatio:"none"},null)),a=ie(t,l)})),()=>{const t=e.bgColor&&te,l=e.fgColor&&le;return c("svg",{height:e.size,width:e.size,viewBox:`0 0 ${n} ${n}`},[!!e.title&&c("title",null,[e.title]),c("path",{fill:t,d:`M0,0 h${n}v${n}H0z`,"shape-rendering":"crispEdges"},null),c("path",{fill:l,d:a,"shape-rendering":"crispEdges"},null),o])}}}),de=E(g({name:"AQrcode",inheritAttrs:!1,props:r(r({},G()),{errorLevel:h("M"),icon:String,iconSize:{type:Number,default:40},status:h("active"),bordered:{type:Boolean,default:!0}}),emits:["refresh"],setup(e,t){let{emit:l,attrs:n,expose:i}=t;const[a]=M("QRCode"),{prefixCls:o}=b("qrcode",e),[s,r]=V(o),[,u]=_(),d=R();i({toDataURL:(e,t)=>{var l;return null===(l=d.value)||void 0===l?void 0:l.toDataURL(e,t)}});const h=v((()=>{const{value:t,icon:l="",size:n=160,iconSize:i=40,color:a=u.value.colorText,bgColor:o="transparent",errorLevel:s="M"}=e,r={src:l,x:void 0,y:void 0,height:i,width:i,excavate:!0};return{value:t,size:n-2*(u.value.paddingSM+u.value.lineWidth),level:s,bgColor:o,fgColor:a,imageSettings:l?r:void 0}}));return()=>{const t=o.value;return s(c("div",C(C({},n),{},{style:[n.style,{width:`${e.size}px`,height:`${e.size}px`,backgroundColor:h.value.bgColor}],class:[r.value,t,{[`${t}-borderless`]:!e.bordered}]}),["active"!==e.status&&c("div",{class:`${t}-mask`},["loading"===e.status&&c(H,null,null),"expired"===e.status&&c(y,null,[c("p",{class:`${t}-expired`},[a.value.expired]),c(S,{type:"link",onClick:e=>l("refresh",e)},{default:()=>[a.value.refresh],icon:()=>c(K,null,null)})]),"scanned"===e.status&&c("p",{class:`${t}-scanned`},[a.value.scanned])]),"canvas"===e.type?c(ue,C({ref:d},h.value),null):c(ce,h.value,null)]))}}})),{currentId:he}=N(a()),fe=A("option-list",(()=>{const i=R([]),a=R([]),o=e=>{a.value=e},s=R({green:0,gray:0,yellow:0,red:0}),r=R(0),u=e=>{r.value=e},c=R(1),d=R(10),h=R([]),f=e=>{h.value=e},g=R(0),m=e=>{g.value=e},p=R(1),w=R(10),C=R(!1),y=e=>{C.value=e},E=R("upload"),M=R(null),b=R(!1),_=R(null),S=R([]),N=R(0),A=R(""),k=R("0"),P=v((()=>"3"===k.value&&""!==A.value)),I=async()=>{_.value&&clearTimeout(_.value);const i=await e(await t.fileList({kb_id:he.value,page_id:c.value,page_limit:d.value}));Object.keys(s.value).forEach((e=>{s.value[e]=0})),Object.assign(s.value,i.status_count),o([]),u(i.total),null==i||i.details.forEach(((e,t)=>{a.value.push({key:null==e?void 0:e.file_id,id:1e4+t,fileId:null==e?void 0:e.file_id,fileIdName:null==e?void 0:e.file_name,fileUrl:null==e?void 0:e.file_url,status:null==e?void 0:e.status,bytes:l((null==e?void 0:e.bytes)||0),contentLength:(null==e?void 0:e.content_length)||0,createtime:n(null==e?void 0:e.timestamp),remark:"gray"===(null==e?void 0:e.status)?"":x(null==e?void 0:e.msg,null==e?void 0:e.status)})}));(null==i?void 0:i.details.some((e=>"gray"===e.status||"yellow"===e.status)))?_.value=setTimeout((()=>{clearTimeout(_.value),I()}),5e3):z()},x=(e="",t="green")=>"green"!==t?e:JSON.parse(e.toString()),z=()=>{let l=null;l=setInterval((async()=>{const n=await e(await t.fileList({kb_id:he.value,page_id:1,page_limit:d.value}));Object.keys(s.value).forEach((e=>{s.value[e]=0})),Object.assign(s.value,n.status_count),u(n.total),0===s.value.gray&&0===s.value.yellow&&clearInterval(l)}),5e3)},T=R(null),O=async()=>{try{T.value&&clearTimeout(T.value),y(!0);const l=await e(await t.fileList({kb_id:he.value.includes("_")?he.value:he.value+"_FAQ",page_id:p.value,page_limit:w.value}));if(f([]),!(null==l?void 0:l.details))return m(0),void y(!1);m(l.total);for(const e of null==l?void 0:l.details){const t=null==l?void 0:l.details.indexOf(e);h.value.push({id:1e4+t,faqId:null==e?void 0:e.file_id,question:null==e?void 0:e.question,answer:null==e?void 0:e.answer,status:null==e?void 0:e.status,bytes:`${null==e?void 0:e.content_length}字符`,createtime:n(null==e?void 0:e.timestamp),picUrlList:[]}),(null==e?void 0:e.picUrlList)&&await F(null==e?void 0:e.picUrlList).then((l=>{h.value[t].picUrlList=null==e?void 0:e.picUrlList.map(((e,t)=>({uid:-t,name:"image",status:"done",url:e,originFileObj:l[t]})))})).catch((e=>{}))}(null==l?void 0:l.details.some((e=>"gray"===e.status||"yellow"===e.status)))&&(T.value=setTimeout((()=>{clearTimeout(T.value),O()}),5e3))}catch(l){L.error(l.msg||"获取faq列表失败")}y(!1)};function F(e){const t=e.map((e=>new Promise(((t,l)=>{fetch(e).then((e=>e.blob())).then((l=>{const n=e.substring(e.lastIndexOf("/")+1),i=new File([l],n,{type:l.type});t(i)})).catch((e=>{l(e)}))}))));return Promise.all(t)}return{dataSource:a,setDataSource:o,faqList:h,setFaqList:f,getDetails:I,timer:_,editQaSet:M,setEditQaSet:e=>{M.value=e},editModalVisible:b,setEditModalVisible:e=>{b.value=e},faqTimer:T,getFaqList:O,faqType:E,setFaqType:e=>{E.value=e},total:g,pageSize:w,setTotal:m,pageNum:p,setPageNum:e=>{p.value=e},loading:C,setLoading:y,totalStatus:s,kbTotal:r,kbPageSize:d,kbPageNum:c,setKbPageNum:e=>{c.value=e},setKbTotal:u,allDataSource:i,getAllDetails:async()=>{let a=1,o=[],s=!0,r=1e4;for(;s;){const l=await e(await t.fileList({kb_id:he.value,page_id:a,page_limit:1e4}));l.details&&l.details.length>0&&(o=o.concat(l.details)),a<l.total_page?a++:s=!1}i.value=o.map((e=>({key:null==e?void 0:e.file_id,id:r++,fileId:null==e?void 0:e.file_id,fileIdName:null==e?void 0:e.file_name,fileLocation:null==e?void 0:e.file_location,fileUrl:null==e?void 0:e.file_url,status:null==e?void 0:e.status,bytes:l((null==e?void 0:e.bytes)||0),contentLength:(null==e?void 0:e.content_length)||0,createtime:n(null==e?void 0:e.timestamp),remark:"gray"===(null==e?void 0:e.status)?"":x(null==e?void 0:e.msg,null==e?void 0:e.status)})))||[]},searchDataSource:S,getSearchData:async i=>{try{const s=await e(await t.fileList({kb_id:he.value,page_id:c.value,page_limit:d.value,file_name_pattern:i}));o=[],S.value=o,a=s.total,N.value=a,null==s||s.details.forEach(((e,t)=>{S.value.push({key:null==e?void 0:e.file_id,id:1e4+t,fileId:null==e?void 0:e.file_id,fileIdName:null==e?void 0:e.file_name,fileUrl:null==e?void 0:e.file_url,status:null==e?void 0:e.status,bytes:l((null==e?void 0:e.bytes)||0),contentLength:(null==e?void 0:e.content_length)||0,createtime:n(null==e?void 0:e.timestamp),remark:"gray"===(null==e?void 0:e.status)?"":x(null==e?void 0:e.msg,null==e?void 0:e.status)})}))}catch(s){}var a,o},searchTotal:N,inputValue:A,typeValue:k,setInputValue:e=>{A.value=e},setTypeValue:e=>{k.value=e},isSearch:P,getAllFileDetails:async l=>{let n=1,i=[],a=!0;for(;a;){const o=await e(await t.fileList({kb_id:l,page_id:n,page_limit:d.value}));o.details&&o.details.length>0&&(i=i.concat(o.details)),n<o.total_page?n++:a=!1}return i.map((e=>({file_name:null==e?void 0:e.file_name,file_location:null==e?void 0:e.file_location})))||[]}}}),{persist:{storage:sessionStorage,paths:["dataSource","faqList","editQaSet","editModalVisible","faqType","total","pageNum","loading","totalStatus","kbPageNum","kbPageSize","allDataSource"]}}),ge=Q().home,ve=Q().common,me=A("knowledgeModal",(()=>{const e=R(!1),l=R(!1),n=R(ge.upload),a=R(""),o=R([]),s=e=>{o.value=e},r=R([]);return{modalVisible:e,setModalVisible:t=>{e.value=t},urlModalVisible:l,setUrlModalVisible:e=>{l.value=e},knowledgeName:a,setKnowledgeName:e=>{a.value=e},fileList:o,setFileList:s,urlList:r,setUrlList:e=>{r.value=e},modalTitle:n,setModalTitle:e=>{n.value=e},$reset:()=>{e.value=!1,n.value=ge.upload,a.value="",o.value=[],r.value=[]},getFileList:async e=>{try{const l=await t.fileList({kb_id:e});200==l.code&&(l.data.details.forEach((e=>{e.errorText=i(e)})),s(l.data.details))}catch(l){L.error(l.msg||ve.error)}}}})),pe={class:"copy-url-comp"},we={class:"title"},Ce={class:"copy-url"},ye={class:"copy-url-span"},Ee={class:"title"},Me={class:"qr-code-content"},be=B(g({__name:"CopyUrlDialog",setup(e){const{copyUrlVisible:t,webUrl:l}=N($()),n=R(null),i=Q().bots;L.config({top:"100px",duration:2,maxCount:3});const a=async()=>{const e=await n.value.toDataURL(),t=document.createElement("a");t.download="QRCode.png",t.href=e,document.body.appendChild(t),t.click(),document.body.removeChild(t)};return(e,o)=>{const s=de,r=S,u=U;return k(),P(D,{to:"body"},[c(u,{open:T(t),"onUpdate:open":o[0]||(o[0]=e=>F(t)?t.value=e:null),title:T(i).copyLink,centered:"",destroyOnClose:!0,"wrap-class-name":"select-knowledge-modal",footer:null},{default:I((()=>[x("div",pe,[x("div",we,z(T(i).UrlLink),1),x("div",Ce,[x("span",ye,z(T(l)),1)]),x("div",Ee,z(T(i).qrCode),1),x("div",Me,[c(s,{ref_key:"qrcode",ref:n,value:T(l),bgColor:"#fff"},null,8,["value"]),c(r,{class:"btn save-btn",onClick:a},{default:I((()=>[O(z(T(i).save),1)])),_:1})])])])),_:1},8,["open","title"])])}}}),[["__scopeId","data-v-537c1f5d"]]),_e=A("useUploadFiles",(()=>{const e=R([]),t=R([]);return{uploadFileList:e,initUploadFileList:()=>{e.value=[]},uploadFileListQuick:t,initUploadFileListQuick:()=>{t.value=[]}}}));export{be as C,fe as a,_e as b,me as u};
